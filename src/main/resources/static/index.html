<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Exam Seating Application</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f4f6f8;
            padding: 20px;
        }
        h1 {
            color: #2c3e50;
        }
        .box {
            background: white;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 6px;
            width: 500px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        input, textarea, button {
            padding: 8px;
            margin: 5px 0;
            width: 100%;
        }
        button {
            background: #3498db;
            color: white;
            border: none;
            cursor: pointer;
        }
        button:hover {
            background: #2980b9;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        th, td {
            border: 1px solid #aaa;
            padding: 8px;
            text-align: center;
        }
        th {
            background: #2ecc71;
            color: white;
        }
        .danger {
            background: #e74c3c;
        }
        .danger:hover {
            background: #c0392b;
        }
    </style>
</head>

<body>

<h1>ðŸŽ“ Exam Seating Application</h1>

<!-- ADD STUDENT -->
<div class="box">
    <h3>âž• Add Student</h3>
    <input id="name" placeholder="Student Name">
    <input id="hall" placeholder="Hall Name">
    <button onclick="addStudent()">Add Student</button>
</div>

<!-- BULK ADD -->
<div class="box">
    <h3>ðŸ“¦ Bulk Add Students</h3>
    <textarea id="bulk" rows="4"
        placeholder="Ravi,Hall-A
Anu,Hall-A
Sita,Hall-B"></textarea>
    <button onclick="addBulk()">Add Bulk</button>
</div>

<!-- STUDENT LIST -->
<div class="box">
    <h3>ðŸ“‹ Students</h3>
    <button onclick="loadStudents()">Load Students</button>
    <table id="table">
        <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Hall</th>
            <th>Seat</th>
            <th>Actions</th>
        </tr>
    </table>
</div>

<!-- SEATING ARRANGEMENT -->
<div class="box">
    <h3>ðŸª‘ Seating Arrangement</h3>
    <button onclick="loadSeating()">Show Seating</button>
    <table id="seatingTable">
    <tr>
        <th>Hall</th>
        <th>Students (Seat Order)</th>
    </tr>
</table>
</div>

<script>
const base = "http://localhost:8083/students";

// CREATE
function addStudent() {
    fetch(base, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ name: name.value, hall: hall.value })
    }).then(loadStudents);
}

// BULK CREATE
function addBulk() {
    const arr = bulk.value.split("\n").map(l => {
        const p = l.split(",");
        return { name: p[0], hall: p[1] };
    });
    fetch(base + "/bulk", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(arr)
    }).then(loadStudents);
}

// READ
function loadStudents() {
    fetch(base)
        .then(r => r.json())
        .then(data => {
            table.innerHTML = `
                <tr>
                    <th>ID</th>
                    <th>Name</th>
                    <th>Hall</th>
                    <th>Seat</th>
                    <th>Actions</th>
                </tr>`;
            data.forEach(s => {
                table.innerHTML += `
                    <tr>
                        <td>${s.id}</td>
                        <td>${s.name}</td>
                        <td>${s.hall}</td>
                        <td>${s.seatNumber}</td>
                        <td>
                            <button onclick="updateStudent(${s.id})">Update</button>
                            <button class="danger" onclick="deleteStudent(${s.id})">Delete</button>
                        </td>
                    </tr>`;
            });
        });
}

// UPDATE
function updateStudent(id) {
    const newName = prompt("Enter new name");
    const newHall = prompt("Enter new hall");
    fetch(base + "/" + id, {
        method: "PUT",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ name: newName, hall: newHall })
    }).then(loadStudents);
}

// DELETE
function deleteStudent(id) {
    if(confirm("Are you sure you want to delete this student?")){
        fetch(base + "/" + id, { method: "DELETE" })
            .then(loadStudents);
    }
}

// SEATING ARRANGEMENT
function loadSeating() {
    fetch(base + "/seating-arrangement")
        .then(r => r.json())
        .then(data => {
            const table = document.getElementById("seatingTable");
            table.innerHTML = `
                <tr>
                    <th>Hall</th>
                    <th>Students (Seat Order)</th>
                </tr>`;
            for (let hall in data) {
                table.innerHTML += `
                    <tr>
                        <td>${hall}</td>
                        <td>${data[hall].map(s => s.name + " (Seat " + s.seatNumber + ")").join(", ")}</td>
                    </tr>`;
            }
        });
}
</script>

</body>
</html>
